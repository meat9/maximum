# maximum

## Подробности по выполнению задания:

### В БД лежат две таблицы:
таблица sessions, в которой хранится информация о сессиях 1 000 случайно отобранных посетителей двух сайтов, произошедших за небольшой период в 2018 году;
таблица communications, в которой хранится информация обо всех обращениях этих пользователей, произошедших за тот же период.

## Создан скрипт на языке python, который:
1) Создает подключение к БД
2) Отправляет на сервер sql-инструкцию и скачивает результат ее выполнения
3) Сохраняет результат в объект pd.DataFrame
4) Записывает объект в csv-файл

## SQL-запрос
SQL-запрос возвращает список всех обращений. Для каждого обращения (communication_id) найдена одна – последняя на момент обращения – предшествующая сессия данного посетителя на том же самом сайте, что и обращение. Кроме того, указано, которая это по счету сессия данного посетителя на данном сайте. Наконец, если для какого-то обращения нет ни одной предшествующей сессии, оно (обращение) все равно возвращается с пустой информацией о сессии.
Например, если сессий у пользователя на одном сайте было три: 3, 4 и 6 апреля 2018 года, а обращение одно – 5 апреля, то будет найдена сессия от 4 апреля и указано, что она была второй по порядку.
В конечной таблице есть следующие поля: communication_id, site_id, visitor_id, communication_date_time, visitor_session_id, session_date_time, campaign_id, row_n (порядковый номер сессии этого пользователя в рамках этого сайта).
